(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5d845e3c"],{"59b6":function(e,t,a){"use strict";a("7f47")},"5cbd":function(e,t,a){"use strict";var o={data:function(){return{isValid:!1}},methods:{validation:function(){var e=this,t=document.querySelector(".needs-validation");t.addEventListener("submit",(function(a){e.validated(a,t)})),t.addEventListener("change",(function(a){e.validated(a,t)}))},validated:function(e,t){t.classList.remove("was-validated"),t.checkValidity()?this.isValid=!0:(e.preventDefault(),e.stopPropagation(),this.isValid=!1),t.classList.add("was-validated")}},mounted:function(){this.validation()}};a("59b6");const l=o;t["a"]=l},"7f47":function(e,t,a){},d0a3:function(e,t,a){"use strict";a.r(t);var o=a("7a23"),l={class:"container-fluid"},c={class:"text-end mb-3"},n=Object(o["createElementVNode"])("i",{class:"material-icons me-1"},"add_circle_outline",-1),d=Object(o["createTextVNode"])(" 新增優惠券 "),s=[n,d],i=Object(o["createStaticVNode"])('<ul class="row g-0 list-unstyled rounded p-2 products-list-header text-nowrap"><li class="col-3 text-start">優惠券標題</li><li class="col-2">優惠碼</li><li class="col-1">折扣</li><li class="col">起始日</li><li class="col">截止日</li><li class="col-1">啟用</li><li class="col-2"></li></ul>',1),r={class:"list-group list-group-flush shadow-sm"},u={class:"col-3 text-start"},m={class:"col-2"},b={class:"col-1"},p={class:"col"},j={key:0,class:"d-block"},O={class:"col-1 text-success"},f={key:0,class:"material-icons fs-5"},h={class:"col-2 d-flex justify-content-start"},g=["onClick"],V=["onClick"],v=Object(o["createTextVNode"])(" 是否刪除 "),N={class:"text-danger"},E=Object(o["createTextVNode"])(" 優惠券？ "),y=Object(o["createElementVNode"])("small",{class:"text-muted"},"(刪除後將無法恢復)",-1);function D(e,t,a,n,d,D){var k=Object(o["resolveComponent"])("Pagination"),C=Object(o["resolveComponent"])("CouponModal"),x=Object(o["resolveComponent"])("DeleteModal");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",l,[Object(o["createElementVNode"])("div",c,[Object(o["createElementVNode"])("button",{class:"btn btn-primary ms-auto",type:"button",onClick:t[0]||(t[0]=function(){return D.openModal&&D.openModal.apply(D,arguments)})},s)]),i,Object(o["createElementVNode"])("ul",r,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(d.coupons,(function(e){return Object(o["openBlock"])(),Object(o["createElementBlock"])("li",{class:"list-group-item p-2",key:e.id},[Object(o["createElementVNode"])("div",u,Object(o["toDisplayString"])(e.title),1),Object(o["createElementVNode"])("div",m,Object(o["toDisplayString"])(e.code),1),Object(o["createElementVNode"])("div",b,Object(o["toDisplayString"])(e.percent),1),Object(o["createElementVNode"])("div",p,Object(o["toDisplayString"])(D.getDate(e.start_date)),1),Object(o["createElementVNode"])("div",{class:Object(o["normalizeClass"])(["col",e.due_date<d.today?"text-danger":""])},[Object(o["createTextVNode"])(Object(o["toDisplayString"])(D.getDate(e.due_date))+" ",1),e.due_date<d.today?(Object(o["openBlock"])(),Object(o["createElementBlock"])("small",j,"(已過期)")):Object(o["createCommentVNode"])("",!0)],2),Object(o["createElementVNode"])("div",O,[e.is_enabled?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",f,"check_circle")):Object(o["createCommentVNode"])("",!0)]),Object(o["createElementVNode"])("div",h,[Object(o["createElementVNode"])("button",{class:"btn btn-sm btn-outline-primary fs-7",type:"button",onClick:function(t){return D.openModal("edit",e)}}," 編輯 ",8,g),Object(o["createElementVNode"])("button",{class:"btn btn-sm btn-outline-danger fs-7 ms-2 ms-md-3",type:"button",onClick:function(t){return D.openModal("delete",e)}}," 刪除 ",8,V)])])})),128))]),Object(o["createVNode"])(k,{pages:d.pages,onGetDatas:D.getCoupons},null,8,["pages","onGetDatas"]),Object(o["createVNode"])(C,{modalData:d.modalData,onUpdateData:D.updateCoupons},{title:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(d.modalTitle),1)]})),_:1},8,["modalData","onUpdateData"]),Object(o["createVNode"])(x,{modalData:d.deleteData,onDeleteData:D.deleteCoupon},{title:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(d.modalTitle),1)]})),default:Object(o["withCtx"])((function(){return[v,Object(o["createElementVNode"])("span",N,Object(o["toDisplayString"])(d.deleteData.title),1),E,y]})),_:1},8,["modalData","onDeleteData"])])}var k=a("5530"),C=(a("d3b7"),a("159b"),a("a397")),x=a("25f3"),_={class:"modal-dialog modal-dialog-centered"},w={class:"modal-content border-0"},M={class:"modal-header bg-dark p-3 text-light"},T=Object(o["createTextVNode"])("新增優惠券"),$=Object(o["createElementVNode"])("button",{type:"button",class:"btn-close me-1","data-bs-dismiss":"modal"},[Object(o["createElementVNode"])("i",{class:"material-icons"},"close")],-1),S={class:"modal-body"},B={class:"row g-2"},U={class:"col-5"},L=Object(o["createElementVNode"])("label",{for:"title",class:"form-label"},"優惠券標題",-1),q={class:"col-5"},P=Object(o["createElementVNode"])("label",{for:"code",class:"form-label"},"優惠碼",-1),G={class:"col"},I=Object(o["createElementVNode"])("label",{for:"percent",class:"form-label"},"折扣 (%)",-1),J=Object(o["createElementVNode"])("div",{class:"d-flex justify-content-between"},[Object(o["createElementVNode"])("label",{for:"start-date",class:"form-label col-6 m-0"},"起始日"),Object(o["createElementVNode"])("label",{for:"end-dete",class:"form-label col-6 m-0 ps-3"}," 截止日")],-1),z={class:"d-flex justify-content-between align-items-center"},F={class:"col"},A={class:"input-group"},H=["value"],K=["onClick"],Q=Object(o["createElementVNode"])("i",{class:"far fa-calendar-alt fa-lg"},null,-1),R=[Q],W=Object(o["createElementVNode"])("div",{class:"col-1 text-center"},"～",-1),X={class:"col"},Y={class:"input-group"},Z=["value"],ee=["onClick"],te=Object(o["createElementVNode"])("i",{class:"far fa-calendar-alt fa-lg"},null,-1),ae=[te],oe=Object(o["createElementVNode"])("hr",{class:"my-4"},null,-1),le={class:"d-flex align-items-center"},ce=Object(o["createElementVNode"])("label",{class:"form-label m-0",for:"coupon-active"},"是否啟用",-1),ne={class:"switch-group ms-2"},de=["checked","disabled"],se=Object(o["createElementVNode"])("div",{class:"ico_switch"},null,-1),ie={class:"modal-footer"},re=Object(o["createElementVNode"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ue(e,t,a,l,c,n){var d=Object(o["resolveComponent"])("v-date-picker");return Object(o["openBlock"])(),Object(o["createElementBlock"])("form",{class:"modal fade needs-validation",id:"couponModal","data-bs-backdrop":"static","data-bs-keyboard":"false",novalidate:"",onSubmit:t[7]||(t[7]=Object(o["withModifiers"])((function(){}),["prevent"]))},[Object(o["createElementVNode"])("div",_,[Object(o["createElementVNode"])("div",w,[Object(o["createElementVNode"])("div",M,[Object(o["renderSlot"])(e.$slots,"title",{},(function(){return[T]})),$]),Object(o["createElementVNode"])("div",S,[Object(o["createElementVNode"])("div",B,[Object(o["createElementVNode"])("div",U,[L,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"text",class:"form-control",placeholder:"輸入標題",id:"title","onUpdate:modelValue":t[0]||(t[0]=function(e){return c.datas.title=e}),required:""},null,512),[[o["vModelText"],c.datas.title,void 0,{trim:!0}]])]),Object(o["createElementVNode"])("div",q,[P,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"text",class:"form-control",placeholder:"輸入優惠碼",id:"code","onUpdate:modelValue":t[1]||(t[1]=function(e){return c.datas.code=e}),required:""},null,512),[[o["vModelText"],c.datas.code,void 0,{trim:!0}]])]),Object(o["createElementVNode"])("div",G,[I,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"number",min:"0",max:"100",class:"form-control no-valid",id:"percent","onUpdate:modelValue":t[2]||(t[2]=function(e){return c.datas.percent=e})},null,512),[[o["vModelText"],c.datas.percent,void 0,{number:!0}]])]),J,Object(o["createElementVNode"])("div",z,[Object(o["createElementVNode"])("div",F,[Object(o["createVNode"])(d,{color:"indigo",class:"inline-block h-full",modelValue:c.datas.start_date,"onUpdate:modelValue":t[3]||(t[3]=function(e){return c.datas.start_date=e}),"model-config":c.modelConfig},{default:Object(o["withCtx"])((function(e){var t=e.inputValue,a=e.togglePopover;return[Object(o["createElementVNode"])("div",A,[Object(o["createElementVNode"])("input",{class:"form-control",id:"start-date",value:t},null,8,H),Object(o["createElementVNode"])("button",{class:"btn btn-sm btn-outline-primary",onClick:function(e){return a()}},R,8,K)])]})),_:1},8,["modelValue","model-config"])]),W,Object(o["createElementVNode"])("div",X,[Object(o["createVNode"])(d,{color:"indigo",class:"inline-block h-full",modelValue:c.datas.due_date,"onUpdate:modelValue":t[4]||(t[4]=function(e){return c.datas.due_date=e}),"model-config":c.modelConfig},{default:Object(o["withCtx"])((function(e){var t=e.inputValue,a=e.togglePopover;return[Object(o["createElementVNode"])("div",Y,[Object(o["createElementVNode"])("input",{class:"form-control",id:"end-date",value:t},null,8,Z),Object(o["createElementVNode"])("button",{class:"btn btn-sm btn-outline-primary",onClick:function(e){return a()}},ae,8,ee)])]})),_:1},8,["modelValue","model-config"])])])]),oe,Object(o["createElementVNode"])("div",le,[ce,Object(o["createElementVNode"])("div",ne,[Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"checkbox",id:"coupon-active",role:"button","onUpdate:modelValue":t[5]||(t[5]=function(e){return c.datas.is_enabled=e}),checked:c.datas.is_enabled?c.datas.is_enabled=1:c.datas.is_enabled=0,disabled:c.datas.due_date<c.today},null,8,de),[[o["vModelCheckbox"],c.datas.is_enabled]]),se])])]),Object(o["createElementVNode"])("div",ie,[re,Object(o["createElementVNode"])("button",{type:"submit",class:"btn btn-primary",onClick:t[6]||(t[6]=function(){return n.updateDatas&&n.updateDatas.apply(n,arguments)})}," 儲存 ")])])])],32)}var me=a("5cbd"),be={props:["modalData"],mixins:[me["a"]],emits:["page-loading","push-message","update-data"],data:function(){return{datas:{},modelConfig:{type:"number"},today:new Date}},methods:{updateDatas:function(){this.isValid&&this.$emit("update-data",this.datas)}},watch:{modalData:function(){this.datas=Object(k["a"])({},this.modalData),document.querySelector("form").classList.remove("was-validated"),this.validation()},datas:{handler:function(e,t){e.due_date<this.today&&(this.datas.is_enabled=0),e.due_date<e.start_date&&(this.$pushMessage(!1,"截止日不可小於起始日"),this.datas.due_date=t.due_date)},deep:!0}}},pe=a("6b0d"),je=a.n(pe);const Oe=je()(be,[["render",ue]]);var fe=Oe,he=a("6da5"),ge={emits:["page-loading","push-message"],components:{CouponModal:fe,DeleteModal:he["a"]},data:function(){return{coupons:[],modal:{},modalData:{},deleteData:{},modalTitle:"",isModal:"",apiInfo:{method:"",id:""},today:new Date,pages:{}}},methods:{getCoupons:function(){var e=this;Object(C["q"])().then((function(t){t.data.success||e.$pushMessage(),e.coupons=t.data.coupons,e.pages=t.data.pagination,e.coupons.forEach((function(t){var a=t;t.due_date<e.today&&(a.is_enabled=0)})),e.$emitter.emit("page-loading",!1)})).catch((function(t){e.$emitter.emit("page-loading",!1),e.$pushMessage(t)}))},getDate:function(e){return Object(x["e"])(e)},updateCoupons:function(e){var t=this,a=this.apiInfo,o=a.method,l=a.id;switch(this.isModal){case"edit":o="put",l=e.id;break;default:o="post",l="";break}this.$emitter.emit("page-loading",!0),Object(C["y"])(o,{data:e},l).then((function(e){e.data.success&&(t.getCoupons(),t.modal.hide()),t.$pushMessage(e),t.$emitter.emit("page-loading",!1)})).catch((function(e){t.$emitter.emit("page-loading",!1),t.$pushMessage(e)}))},deleteCoupon:function(e){var t=this;this.$emitter.emit("page-loading",!0),Object(C["g"])(e.id).then((function(e){e.data.success&&(t.getCoupons(),t.modal.hide()),t.$pushMessage(e),t.$emitter.emit("page-loading",!1)})).catch((function(e){t.$emitter.emit("page-loading",!1),t.$pushMessage(e)}))},openModal:function(e,t){"edit"===e?(this.modal=Object(x["a"])("couponModal"),this.modalData=Object(k["a"])({},t),this.isModal="edit",this.modalTitle="編輯優惠券：".concat(t.id)):"delete"===e?(this.modal=Object(x["a"])("deleteModal"),this.deleteData=t,this.modalTitle="刪除優惠券：".concat(t.code)):(this.modal=Object(x["a"])("couponModal"),this.modalData={},this.modalTitle="新增優惠券",this.modalData={start_date:this.today.getTime(),due_date:this.today.getTime(),percent:100},this.isModal=""),this.modal.show()}},created:function(){this.$emitter.emit("page-loading",!0),this.getCoupons()}};const Ve=je()(ge,[["render",D]]);t["default"]=Ve}}]);
//# sourceMappingURL=chunk-5d845e3c.ad6236c8.js.map